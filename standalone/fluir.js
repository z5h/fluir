!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.fluir=e()}}(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){function Application(nameToStores){this._stores=_.values(nameToStores),EventEmitter.call(this),_.extend(this,EventEmitter.prototype),Scope.call(this,nameToStores),this.get=Scope.prototype.get,RouteHandler.call(this,this._stores),_.extend(this,RouteHandler.prototype),DispatchHandler.call(this,this._stores),this.dispatch=_.bind(function(event,payload){return DispatchHandler.prototype.dispatch.call(this,event,payload)},this),this.emitChange=_.bind(function(){return Application.prototype.emitChange.call(this)},this);var self=this;_.each(this._stores,function(store){store.on("change",function(){self.emitChange(store)}),store.go=_.bind(self.go,self),store.scope=_.bind(self.push,self)})}var _=require("underscore"),EventEmitter=require("events").EventEmitter,Scope=require("./lib/scope").Scope,RouteHandler=require("./lib/routeHandler").RouteHandler,DispatchHandler=require("./lib/dispatchHandler").DispatchHandler;Application.prototype.push=function(map){var result=Scope.prototype.push.call(this,map);return result.dispatch=this.dispatch,result.emitChange=this.emitChange,result.push=Application.prototype.push,result},Application.prototype.emitChange=function(){this.emit("change")};var ViewMixin={scope:function(values){return values?this.props.scope.push(values):this.props.scope},resolve:function(key){return this.props.scope.get(key)},dispatch:function(event,payload){return this.props.scope.dispatch(event,payload)},dispatcher:function(event){return _.bind(function(e){this.props.scope.dispatch(event,e.target.value)},this)}},RootViewMixin={debounceTime:10,componentWillMount:function(){this.callback=function(){this.forceUpdate()}.bind(this),this.props.scope.on("change",_.debounce(this.callback,this.debounceTime))}};_.extend(RootViewMixin,ViewMixin),exports.Application=Application,exports.ViewMixin=ViewMixin,exports.RootViewMixin=RootViewMixin},{"./lib/dispatchHandler":2,"./lib/routeHandler":3,"./lib/scope":4,events:5,underscore:18}],2:[function(require,module,exports){function DispatchHandler(listeners){this._listeners=listeners}var _=require("underscore"),Promise=require("es6-promise").Promise;DispatchHandler.prototype.dispatch=function(event_name,payload){var promises=[];return _.each(this._listeners,function(store){var fn=store[event_name];"function"==typeof fn&&promises.push(fn.call(store,payload))}),Promise.all(promises)},exports.DispatchHandler=DispatchHandler},{"es6-promise":8,underscore:18}],3:[function(require,module,exports){function defineRouteHandler(Router){function RouteHandler(routeDelegates){this._router=new Router;var actions={},self=this;_.each(routeDelegates,function(routeDelegate){_.chain(routeDelegate).functions().filter(function(x){return"/"===x.charAt(0)}).each(function(route){var action=function(){var args=Array.prototype.slice.call(arguments);routeDelegate[route].apply(routeDelegate,args),self.emitChange()};actions[route]=action,self._router.on(route,action)}),_.chain(routeDelegate).keys().filter(function(x){return"/"===x.charAt(0)&&"string"==typeof routeDelegate[x]}).each(function(route){var actionName=routeDelegate[route];self._router.on(route,actions[actionName])})})}return RouteHandler.prototype.initRoute=function(route){this._router.init(route)},RouteHandler.prototype.go=function(url){this._router.setRoute(url)},RouteHandler}var _=require("underscore"),Router=require("director").Router;exports.RouteHandler=defineRouteHandler(Router),exports.defineRouteHandler=defineRouteHandler},{director:7,underscore:18}],4:[function(require,module,exports){function Scope(map){map&&(this._values=map)}Scope.prototype.push=function(values){var scope=new Scope(values||{});return scope._parent=this,scope},Scope.prototype.get=function(key){for(var target=this,result=target._values[key];void 0===result&&target;)target=target._parent,result=target?target._values[key]:result;if(target)return result;throw key+" not found"},exports.Scope=Scope},{}],5:[function(require,module,exports){function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(arg){return"function"==typeof arg}function isNumber(arg){return"number"==typeof arg}function isObject(arg){return"object"==typeof arg&&null!==arg}function isUndefined(arg){return void 0===arg}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||0>n||isNaN(n))throw TypeError("n must be a positive number");return this._maxListeners=n,this},EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(this._events||(this._events={}),"error"===type&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if(er=arguments[1],er instanceof Error)throw er;throw TypeError('Uncaught, unspecified "error" event.')}if(handler=this._events[type],isUndefined(handler))return!1;if(isFunction(handler))switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:for(len=arguments.length,args=new Array(len-1),i=1;len>i;i++)args[i-1]=arguments[i];handler.apply(this,args)}else if(isObject(handler)){for(len=arguments.length,args=new Array(len-1),i=1;len>i;i++)args[i-1]=arguments[i];for(listeners=handler.slice(),len=listeners.length,i=0;len>i;i++)listeners[i].apply(this,args)}return!0},EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener),this._events[type]?isObject(this._events[type])?this._events[type].push(listener):this._events[type]=[this._events[type],listener]:this._events[type]=listener,isObject(this._events[type])&&!this._events[type].warned){var m;m=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners,m&&m>0&&this._events[type].length>m&&(this._events[type].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[type].length),"function"==typeof console.trace&&console.trace())}return this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(type,listener){function g(){this.removeListener(type,g),fired||(fired=!0,listener.apply(this,arguments))}if(!isFunction(listener))throw TypeError("listener must be a function");var fired=!1;return g.listener=listener,this.on(type,g),this},EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;if(list=this._events[type],length=list.length,position=-1,list===listener||isFunction(list.listener)&&list.listener===listener)delete this._events[type],this._events.removeListener&&this.emit("removeListener",type,listener);else if(isObject(list)){for(i=length;i-->0;)if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}if(0>position)return this;1===list.length?(list.length=0,delete this._events[type]):list.splice(position,1),this._events.removeListener&&this.emit("removeListener",type,listener)}return this},EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[type]&&delete this._events[type],this;if(0===arguments.length){for(key in this._events)"removeListener"!==key&&this.removeAllListeners(key);return this.removeAllListeners("removeListener"),this._events={},this}if(listeners=this._events[type],isFunction(listeners))this.removeListener(type,listeners);else for(;listeners.length;)this.removeListener(type,listeners[listeners.length-1]);return delete this._events[type],this},EventEmitter.prototype.listeners=function(type){var ret;return ret=this._events&&this._events[type]?isFunction(this._events[type])?[this._events[type]]:this._events[type].slice():[]},EventEmitter.listenerCount=function(emitter,type){var ret;return ret=emitter._events&&emitter._events[type]?isFunction(emitter._events[type])?1:emitter._events[type].length:0}},{}],6:[function(require,module,exports){function noop(){}var process=module.exports={};process.nextTick=function(){var canSetImmediate="undefined"!=typeof window&&window.setImmediate,canPost="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(canSetImmediate)return function(f){return window.setImmediate(f)};if(canPost){var queue=[];return window.addEventListener("message",function(ev){var source=ev.source;if((source===window||null===source)&&"process-tick"===ev.data&&(ev.stopPropagation(),queue.length>0)){var fn=queue.shift();fn()}},!0),function nextTick(fn){queue.push(fn),window.postMessage("process-tick","*")}}return function nextTick(fn){setTimeout(fn,0)}}(),process.title="browser",process.browser=!0,process.env={},process.argv=[],process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")}},{}],7:[function(require,module,exports){!function(exports){function dlocHashEmpty(){return""===dloc.hash||"#"===dloc.hash}function _every(arr,iterator){for(var i=0;i<arr.length;i+=1)if(iterator(arr[i],i,arr)===!1)return}function _flatten(arr){for(var flat=[],i=0,n=arr.length;n>i;i++)flat=flat.concat(arr[i]);return flat}function _asyncEverySeries(arr,iterator,callback){if(!arr.length)return callback();var completed=0;!function iterate(){iterator(arr[completed],function(err){err||err===!1?(callback(err),callback=function(){}):(completed+=1,completed===arr.length?callback():iterate())})}()}function paramifyString(str,params,mod){mod=str;for(var param in params)if(params.hasOwnProperty(param)&&(mod=params[param](str),mod!==str))break;return mod===str?"([._a-zA-Z0-9-]+)":mod}function regifyString(str,params){for(var matches,last=0,out="";matches=str.substr(last).match(/[^\w\d\- %@&]*\*[^\w\d\- %@&]*/);)last=matches.index+matches[0].length,matches[0]=matches[0].replace(/^\*/,"([_.()!\\ %@&a-zA-Z0-9-]+)"),out+=str.substr(0,matches.index)+matches[0];str=out+=str.substr(last);var captures=str.match(/:([^\/]+)/gi),capture,length;if(captures){length=captures.length;for(var i=0;length>i;i++)capture=captures[i],str="::"===capture.slice(0,2)?capture.slice(1):str.replace(capture,paramifyString(capture,params))}return str}function terminator(routes,delimiter,start,stop){var last=0,left=0,right=0,start=(start||"(").toString(),stop=(stop||")").toString(),i;for(i=0;i<routes.length;i++){var chunk=routes[i];if(chunk.indexOf(start,last)>chunk.indexOf(stop,last)||~chunk.indexOf(start,last)&&!~chunk.indexOf(stop,last)||!~chunk.indexOf(start,last)&&~chunk.indexOf(stop,last)){if(left=chunk.indexOf(start,last),right=chunk.indexOf(stop,last),~left&&!~right||!~left&&~right){var tmp=routes.slice(0,(i||1)+1).join(delimiter);routes=[tmp].concat(routes.slice((i||1)+1))}last=(right>left?right:left)+1,i=0}else last=0}return routes}Array.prototype.filter||(Array.prototype.filter=function(filter,that){for(var other=[],v,i=0,n=this.length;n>i;i++)i in this&&filter.call(that,v=this[i],i,this)&&other.push(v);return other}),Array.isArray||(Array.isArray=function(obj){return"[object Array]"===Object.prototype.toString.call(obj)});var dloc=document.location,listener={mode:"modern",hash:dloc.hash,history:!1,check:function(){var h=dloc.hash;h!=this.hash&&(this.hash=h,this.onHashChanged())},fire:function(){"modern"===this.mode?this.history===!0?window.onpopstate():window.onhashchange():this.onHashChanged()},init:function(fn,history){function onchange(onChangeEvent){for(var i=0,l=Router.listeners.length;l>i;i++)Router.listeners[i](onChangeEvent)}var self=this;if(this.history=history,Router.listeners||(Router.listeners=[]),"onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7))this.history===!0?setTimeout(function(){window.onpopstate=onchange},500):window.onhashchange=onchange,this.mode="modern";else{var frame=document.createElement("iframe");frame.id="state-frame",frame.style.display="none",document.body.appendChild(frame),this.writeFrame(""),"onpropertychange"in document&&"attachEvent"in document&&document.attachEvent("onpropertychange",function(){"location"===event.propertyName&&self.check()}),window.setInterval(function(){self.check()},50),this.onHashChanged=onchange,this.mode="legacy"}return Router.listeners.push(fn),this.mode},destroy:function(fn){if(Router&&Router.listeners)for(var listeners=Router.listeners,i=listeners.length-1;i>=0;i--)listeners[i]===fn&&listeners.splice(i,1)},setHash:function(s){return"legacy"===this.mode&&this.writeFrame(s),this.history===!0?(window.history.pushState({},document.title,s),this.fire()):dloc.hash="/"===s[0]?s:"/"+s,this},writeFrame:function(s){var f=document.getElementById("state-frame"),d=f.contentDocument||f.contentWindow.document;d.open(),d.write("<script>_hash = '"+s+"'; onload = parent.listener.syncHash;<script>"),d.close()},syncHash:function(){var s=this._hash;return s!=dloc.hash&&(dloc.hash=s),this},onHashChanged:function(){}},Router=exports.Router=function(routes){return this instanceof Router?(this.params={},this.routes={},this.methods=["on","once","after","before"],this.scope=[],this._methods={},this._insert=this.insert,this.insert=this.insertEx,this.historySupport=null!=(null!=window.history?window.history.pushState:null),this.configure(),void this.mount(routes||{})):new Router(routes)};Router.prototype.init=function(r){var self=this;if(this.handler=function(onChangeEvent){var newURL=onChangeEvent&&onChangeEvent.newURL||window.location.hash,url=self.history===!0?self.getPath():newURL.replace(/.*#/,"");self.dispatch("on","/"===url.charAt(0)?url:"/"+url)},listener.init(this.handler,this.history),this.history===!1)dlocHashEmpty()&&r?dloc.hash=r:dlocHashEmpty()||self.dispatch("on","/"+dloc.hash.replace(/^(#\/|#|\/)/,""));else{var routeTo=dlocHashEmpty()&&r?r:dlocHashEmpty()?null:dloc.hash.replace(/^#/,"");routeTo&&window.history.replaceState({},document.title,routeTo),(routeTo||this.run_in_init===!0)&&this.handler()}return this},Router.prototype.explode=function(){var v=this.history===!0?this.getPath():dloc.hash;return"/"===v.charAt(1)&&(v=v.slice(1)),v.slice(1,v.length).split("/")},Router.prototype.setRoute=function(i,v,val){var url=this.explode();return"number"==typeof i&&"string"==typeof v?url[i]=v:"string"==typeof val?url.splice(i,v,s):url=[i],listener.setHash(url.join("/")),url},Router.prototype.insertEx=function(method,path,route,parent){return"once"===method&&(method="on",route=function(route){var once=!1;return function(){return once?void 0:(once=!0,route.apply(this,arguments))}}(route)),this._insert(method,path,route,parent)},Router.prototype.getRoute=function(v){var ret=v;if("number"==typeof v)ret=this.explode()[v];else if("string"==typeof v){var h=this.explode();ret=h.indexOf(v)}else ret=this.explode();return ret},Router.prototype.destroy=function(){return listener.destroy(this.handler),this},Router.prototype.getPath=function(){var path=window.location.pathname;return"/"!==path.substr(0,1)&&(path="/"+path),path},Router.prototype.configure=function(options){options=options||{};for(var i=0;i<this.methods.length;i++)this._methods[this.methods[i]]=!0;return this.recurse=options.recurse||this.recurse||!1,this.async=options.async||!1,this.delimiter=options.delimiter||"/",this.strict="undefined"==typeof options.strict?!0:options.strict,this.notfound=options.notfound,this.resource=options.resource,this.history=options.html5history&&this.historySupport||!1,this.run_in_init=this.history===!0&&options.run_handler_in_init!==!1,this.every={after:options.after||null,before:options.before||null,on:options.on||null},this},Router.prototype.param=function(token,matcher){":"!==token[0]&&(token=":"+token);var compiled=new RegExp(token,"g");this.params[token]=function(str){return str.replace(compiled,matcher.source||matcher)}},Router.prototype.on=Router.prototype.route=function(method,path,route){var self=this;return route||"function"!=typeof path||(route=path,path=method,method="on"),Array.isArray(path)?path.forEach(function(p){self.on(method,p,route)}):(path.source&&(path=path.source.replace(/\\\//gi,"/")),Array.isArray(method)?method.forEach(function(m){self.on(m.toLowerCase(),path,route)}):(path=path.split(new RegExp(this.delimiter)),path=terminator(path,this.delimiter),void this.insert(method,this.scope.concat(path),route)))},Router.prototype.dispatch=function(method,path,callback){function updateAndInvoke(){self.last=fns.after,self.invoke(self.runlist(fns),self,callback)}var self=this,fns=this.traverse(method,path,this.routes,""),invoked=this._invoked,after;return this._invoked=!0,fns&&0!==fns.length?("forward"===this.recurse&&(fns=fns.reverse()),after=this.every&&this.every.after?[this.every.after].concat(this.last):[this.last],after&&after.length>0&&invoked?(this.async?this.invoke(after,this,updateAndInvoke):(this.invoke(after,this),updateAndInvoke()),!0):(updateAndInvoke(),!0)):(this.last=[],"function"==typeof this.notfound&&this.invoke([this.notfound],{method:method,path:path},callback),!1)},Router.prototype.invoke=function(fns,thisArg,callback){var self=this,apply;this.async?(apply=function(fn,next){return Array.isArray(fn)?_asyncEverySeries(fn,apply,next):void("function"==typeof fn&&fn.apply(thisArg,fns.captures.concat(next)))},_asyncEverySeries(fns,apply,function(){callback&&callback.apply(thisArg,arguments)})):(apply=function(fn){return Array.isArray(fn)?_every(fn,apply):"function"==typeof fn?fn.apply(thisArg,fns.captures||[]):void("string"==typeof fn&&self.resource&&self.resource[fn].apply(thisArg,fns.captures||[]))},_every(fns,apply))},Router.prototype.traverse=function(method,path,routes,regexp,filter){function filterRoutes(routes){function deepCopy(source){for(var result=[],i=0;i<source.length;i++)result[i]=Array.isArray(source[i])?deepCopy(source[i]):source[i];return result}function applyFilter(fns){for(var i=fns.length-1;i>=0;i--)Array.isArray(fns[i])?(applyFilter(fns[i]),0===fns[i].length&&fns.splice(i,1)):filter(fns[i])||fns.splice(i,1)}if(!filter)return routes;var newRoutes=deepCopy(routes);return newRoutes.matched=routes.matched,newRoutes.captures=routes.captures,newRoutes.after=routes.after.filter(filter),applyFilter(newRoutes),newRoutes}var fns=[],current,exact,match,next,that;if(path===this.delimiter&&routes[method])return next=[[routes.before,routes[method]].filter(Boolean)],next.after=[routes.after].filter(Boolean),next.matched=!0,next.captures=[],filterRoutes(next);for(var r in routes)if(routes.hasOwnProperty(r)&&(!this._methods[r]||this._methods[r]&&"object"==typeof routes[r]&&!Array.isArray(routes[r]))){if(current=exact=regexp+this.delimiter+r,this.strict||(exact+="["+this.delimiter+"]?"),match=path.match(new RegExp("^"+exact)),!match)continue;if(match[0]&&match[0]==path&&routes[r][method])return next=[[routes[r].before,routes[r][method]].filter(Boolean)],next.after=[routes[r].after].filter(Boolean),next.matched=!0,next.captures=match.slice(1),this.recurse&&routes===this.routes&&(next.push([routes.before,routes.on].filter(Boolean)),next.after=next.after.concat([routes.after].filter(Boolean))),filterRoutes(next);if(next=this.traverse(method,path,routes[r],current),next.matched)return next.length>0&&(fns=fns.concat(next)),this.recurse&&(fns.push([routes[r].before,routes[r].on].filter(Boolean)),next.after=next.after.concat([routes[r].after].filter(Boolean)),routes===this.routes&&(fns.push([routes.before,routes.on].filter(Boolean)),next.after=next.after.concat([routes.after].filter(Boolean)))),fns.matched=!0,fns.captures=next.captures,fns.after=next.after,filterRoutes(fns)}return!1},Router.prototype.insert=function(method,path,route,parent){var methodType,parentType,isArray,nested,part;if(path=path.filter(function(p){return p&&p.length>0}),parent=parent||this.routes,part=path.shift(),/\:|\*/.test(part)&&!/\\d|\\w/.test(part)&&(part=regifyString(part,this.params)),path.length>0)return parent[part]=parent[part]||{},this.insert(method,path,route,parent[part]);if(part||path.length||parent!==this.routes){if(parentType=typeof parent[part],isArray=Array.isArray(parent[part]),parent[part]&&!isArray&&"object"==parentType)switch(methodType=typeof parent[part][method]){case"function":return void(parent[part][method]=[parent[part][method],route]);case"object":return void parent[part][method].push(route);case"undefined":return void(parent[part][method]=route)}else if("undefined"==parentType)return nested={},nested[method]=route,void(parent[part]=nested);throw new Error("Invalid route context: "+parentType)}switch(methodType=typeof parent[method]){case"function":return void(parent[method]=[parent[method],route]);case"object":return void parent[method].push(route);case"undefined":return void(parent[method]=route)}},Router.prototype.extend=function(methods){function extend(method){self._methods[method]=!0,self[method]=function(){var extra=1===arguments.length?[method,""]:[method];self.on.apply(self,extra.concat(Array.prototype.slice.call(arguments)))}}var self=this,len=methods.length,i;for(i=0;len>i;i++)extend(methods[i])},Router.prototype.runlist=function(fns){var runlist=this.every&&this.every.before?[this.every.before].concat(_flatten(fns)):_flatten(fns);return this.every&&this.every.on&&runlist.push(this.every.on),runlist.captures=fns.captures,runlist.source=fns.source,runlist},Router.prototype.mount=function(routes,path){function insertOrMount(route,local){var rename=route,parts=route.split(self.delimiter),routeType=typeof routes[route],isRoute=""===parts[0]||!self._methods[parts[0]],event=isRoute?"on":rename;return isRoute&&(rename=rename.slice((rename.match(new RegExp("^"+self.delimiter))||[""])[0].length),parts.shift()),isRoute&&"object"===routeType&&!Array.isArray(routes[route])?(local=local.concat(parts),void self.mount(routes[route],local)):(isRoute&&(local=local.concat(rename.split(self.delimiter)),local=terminator(local,self.delimiter)),void self.insert(event,local,routes[route]))}if(routes&&"object"==typeof routes&&!Array.isArray(routes)){var self=this;path=path||[],Array.isArray(path)||(path=path.split(self.delimiter));for(var route in routes)routes.hasOwnProperty(route)&&insertOrMount(route,path.slice(0))}}}("object"==typeof exports?exports:window)},{}],8:[function(require,module,exports){"use strict";var Promise=require("./promise/promise").Promise,polyfill=require("./promise/polyfill").polyfill;exports.Promise=Promise,exports.polyfill=polyfill},{"./promise/polyfill":12,"./promise/promise":13}],9:[function(require,module,exports){"use strict";function all(promises){var Promise=this;if(!isArray(promises))throw new TypeError("You must pass an array to all.");return new Promise(function(resolve,reject){function resolver(index){return function(value){resolveAll(index,value)}}function resolveAll(index,value){results[index]=value,0===--remaining&&resolve(results)}var results=[],remaining=promises.length,promise;0===remaining&&resolve([]);for(var i=0;i<promises.length;i++)promise=promises[i],promise&&isFunction(promise.then)?promise.then(resolver(i),reject):resolveAll(i,promise)})}var isArray=require("./utils").isArray,isFunction=require("./utils").isFunction;exports.all=all},{"./utils":17}],10:[function(require,module,exports){(function(process,global){"use strict";function useNextTick(){return function(){process.nextTick(flush)}}function useMutationObserver(){var iterations=0,observer=new BrowserMutationObserver(flush),node=document.createTextNode("");return observer.observe(node,{characterData:!0}),function(){node.data=iterations=++iterations%2}}function useSetTimeout(){return function(){local.setTimeout(flush,1)}}function flush(){for(var i=0;i<queue.length;i++){var tuple=queue[i],callback=tuple[0],arg=tuple[1];callback(arg)}queue=[]}function asap(callback,arg){var length=queue.push([callback,arg]);1===length&&scheduleFlush()}var browserGlobal="undefined"!=typeof window?window:{},BrowserMutationObserver=browserGlobal.MutationObserver||browserGlobal.WebKitMutationObserver,local="undefined"!=typeof global?global:void 0===this?window:this,queue=[],scheduleFlush;scheduleFlush="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?useNextTick():BrowserMutationObserver?useMutationObserver():useSetTimeout(),exports.asap=asap}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:6}],11:[function(require,module,exports){"use strict";function configure(name,value){return 2!==arguments.length?config[name]:void(config[name]=value)}var config={instrument:!1};exports.config=config,exports.configure=configure},{}],12:[function(require,module,exports){(function(global){"use strict";function polyfill(){var local;local="undefined"!=typeof global?global:"undefined"!=typeof window&&window.document?window:self;var es6PromiseSupport="Promise"in local&&"resolve"in local.Promise&&"reject"in local.Promise&&"all"in local.Promise&&"race"in local.Promise&&function(){var resolve;return new local.Promise(function(r){resolve=r}),isFunction(resolve)}();es6PromiseSupport||(local.Promise=RSVPPromise)}var RSVPPromise=require("./promise").Promise,isFunction=require("./utils").isFunction;exports.polyfill=polyfill}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./promise":13,"./utils":17}],13:[function(require,module,exports){"use strict";function Promise(resolver){if(!isFunction(resolver))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof Promise))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],invokeResolver(resolver,this)}function invokeResolver(resolver,promise){function resolvePromise(value){resolve(promise,value)}function rejectPromise(reason){reject(promise,reason)}try{resolver(resolvePromise,rejectPromise)}catch(e){rejectPromise(e)}}function invokeCallback(settled,promise,callback,detail){var hasCallback=isFunction(callback),value,error,succeeded,failed;if(hasCallback)try{value=callback(detail),succeeded=!0}catch(e){failed=!0,error=e}else value=detail,succeeded=!0;handleThenable(promise,value)||(hasCallback&&succeeded?resolve(promise,value):failed?reject(promise,error):settled===FULFILLED?resolve(promise,value):settled===REJECTED&&reject(promise,value))}function subscribe(parent,child,onFulfillment,onRejection){var subscribers=parent._subscribers,length=subscribers.length;subscribers[length]=child,subscribers[length+FULFILLED]=onFulfillment,subscribers[length+REJECTED]=onRejection}function publish(promise,settled){for(var child,callback,subscribers=promise._subscribers,detail=promise._detail,i=0;i<subscribers.length;i+=3)child=subscribers[i],callback=subscribers[i+settled],invokeCallback(settled,child,callback,detail);promise._subscribers=null}function handleThenable(promise,value){var then=null,resolved;try{if(promise===value)throw new TypeError("A promises callback cannot return that same promise.");if(objectOrFunction(value)&&(then=value.then,isFunction(then)))return then.call(value,function(val){return resolved?!0:(resolved=!0,void(value!==val?resolve(promise,val):fulfill(promise,val)))},function(val){return resolved?!0:(resolved=!0,void reject(promise,val))}),!0}catch(error){return resolved?!0:(reject(promise,error),!0)}return!1}function resolve(promise,value){promise===value?fulfill(promise,value):handleThenable(promise,value)||fulfill(promise,value)}function fulfill(promise,value){promise._state===PENDING&&(promise._state=SEALED,promise._detail=value,config.async(publishFulfillment,promise))}function reject(promise,reason){promise._state===PENDING&&(promise._state=SEALED,promise._detail=reason,config.async(publishRejection,promise))}function publishFulfillment(promise){publish(promise,promise._state=FULFILLED)}function publishRejection(promise){publish(promise,promise._state=REJECTED)}var config=require("./config").config,configure=require("./config").configure,objectOrFunction=require("./utils").objectOrFunction,isFunction=require("./utils").isFunction,now=require("./utils").now,all=require("./all").all,race=require("./race").race,staticResolve=require("./resolve").resolve,staticReject=require("./reject").reject,asap=require("./asap").asap,counter=0;config.async=asap;var PENDING=void 0,SEALED=0,FULFILLED=1,REJECTED=2;Promise.prototype={constructor:Promise,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(onFulfillment,onRejection){var promise=this,thenPromise=new this.constructor(function(){});if(this._state){var callbacks=arguments;config.async(function invokePromiseCallback(){invokeCallback(promise._state,thenPromise,callbacks[promise._state-1],promise._detail)})}else subscribe(this,thenPromise,onFulfillment,onRejection);return thenPromise},"catch":function(onRejection){return this.then(null,onRejection)}},Promise.all=all,Promise.race=race,Promise.resolve=staticResolve,Promise.reject=staticReject,exports.Promise=Promise},{"./all":9,"./asap":10,"./config":11,"./race":14,"./reject":15,"./resolve":16,"./utils":17}],14:[function(require,module,exports){"use strict";function race(promises){var Promise=this;if(!isArray(promises))throw new TypeError("You must pass an array to race.");return new Promise(function(resolve,reject){for(var results=[],promise,i=0;i<promises.length;i++)promise=promises[i],promise&&"function"==typeof promise.then?promise.then(resolve,reject):resolve(promise)})}var isArray=require("./utils").isArray;exports.race=race},{"./utils":17}],15:[function(require,module,exports){"use strict";function reject(reason){var Promise=this;return new Promise(function(resolve,reject){reject(reason)})}exports.reject=reject},{}],16:[function(require,module,exports){"use strict";function resolve(value){if(value&&"object"==typeof value&&value.constructor===this)return value;var Promise=this;return new Promise(function(resolve){resolve(value)})}exports.resolve=resolve},{}],17:[function(require,module,exports){"use strict";function objectOrFunction(x){return isFunction(x)||"object"==typeof x&&null!==x}function isFunction(x){return"function"==typeof x}function isArray(x){return"[object Array]"===Object.prototype.toString.call(x)}var now=Date.now||function(){return(new Date).getTime()};exports.objectOrFunction=objectOrFunction,exports.isFunction=isFunction,exports.isArray=isArray,exports.now=now},{}],18:[function(require,module,exports){(function(){var root=this,previousUnderscore=root._,ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,_=function(obj){return obj instanceof _?obj:this instanceof _?void(this._wrapped=obj):new _(obj)
};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_):root._=_,_.VERSION="1.7.0";var createCallback=function(func,context,argCount){if(void 0===context)return func;switch(null==argCount?3:argCount){case 1:return function(value){return func.call(context,value)};case 2:return function(value,other){return func.call(context,value,other)};case 3:return function(value,index,collection){return func.call(context,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection)}}return function(){return func.apply(context,arguments)}};_.iteratee=function(value,context,argCount){return null==value?_.identity:_.isFunction(value)?createCallback(value,context,argCount):_.isObject(value)?_.matches(value):_.property(value)},_.each=_.forEach=function(obj,iteratee,context){if(null==obj)return obj;iteratee=createCallback(iteratee,context);var i,length=obj.length;if(length===+length)for(i=0;length>i;i++)iteratee(obj[i],i,obj);else{var keys=_.keys(obj);for(i=0,length=keys.length;length>i;i++)iteratee(obj[keys[i]],keys[i],obj)}return obj},_.map=_.collect=function(obj,iteratee,context){if(null==obj)return[];iteratee=_.iteratee(iteratee,context);for(var keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length,results=Array(length),currentKey,index=0;length>index;index++)currentKey=keys?keys[index]:index,results[index]=iteratee(obj[currentKey],currentKey,obj);return results};var reduceError="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(obj,iteratee,memo,context){null==obj&&(obj=[]),iteratee=createCallback(iteratee,context,4);var keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length,index=0,currentKey;if(arguments.length<3){if(!length)throw new TypeError(reduceError);memo=obj[keys?keys[index++]:index++]}for(;length>index;index++)currentKey=keys?keys[index]:index,memo=iteratee(memo,obj[currentKey],currentKey,obj);return memo},_.reduceRight=_.foldr=function(obj,iteratee,memo,context){null==obj&&(obj=[]),iteratee=createCallback(iteratee,context,4);var keys=obj.length!==+obj.length&&_.keys(obj),index=(keys||obj).length,currentKey;if(arguments.length<3){if(!index)throw new TypeError(reduceError);memo=obj[keys?keys[--index]:--index]}for(;index--;)currentKey=keys?keys[index]:index,memo=iteratee(memo,obj[currentKey],currentKey,obj);return memo},_.find=_.detect=function(obj,predicate,context){var result;return predicate=_.iteratee(predicate,context),_.some(obj,function(value,index,list){return predicate(value,index,list)?(result=value,!0):void 0}),result},_.filter=_.select=function(obj,predicate,context){var results=[];return null==obj?results:(predicate=_.iteratee(predicate,context),_.each(obj,function(value,index,list){predicate(value,index,list)&&results.push(value)}),results)},_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(_.iteratee(predicate)),context)},_.every=_.all=function(obj,predicate,context){if(null==obj)return!0;predicate=_.iteratee(predicate,context);var keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length,index,currentKey;for(index=0;length>index;index++)if(currentKey=keys?keys[index]:index,!predicate(obj[currentKey],currentKey,obj))return!1;return!0},_.some=_.any=function(obj,predicate,context){if(null==obj)return!1;predicate=_.iteratee(predicate,context);var keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length,index,currentKey;for(index=0;length>index;index++)if(currentKey=keys?keys[index]:index,predicate(obj[currentKey],currentKey,obj))return!0;return!1},_.contains=_.include=function(obj,target){return null==obj?!1:(obj.length!==+obj.length&&(obj=_.values(obj)),_.indexOf(obj,target)>=0)},_.invoke=function(obj,method){var args=slice.call(arguments,2),isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args)})},_.pluck=function(obj,key){return _.map(obj,_.property(key))},_.where=function(obj,attrs){return _.filter(obj,_.matches(attrs))},_.findWhere=function(obj,attrs){return _.find(obj,_.matches(attrs))},_.max=function(obj,iteratee,context){var result=-1/0,lastComputed=-1/0,value,computed;if(null==iteratee&&null!=obj){obj=obj.length===+obj.length?obj:_.values(obj);for(var i=0,length=obj.length;length>i;i++)value=obj[i],value>result&&(result=value)}else iteratee=_.iteratee(iteratee,context),_.each(obj,function(value,index,list){computed=iteratee(value,index,list),(computed>lastComputed||computed===-1/0&&result===-1/0)&&(result=value,lastComputed=computed)});return result},_.min=function(obj,iteratee,context){var result=1/0,lastComputed=1/0,value,computed;if(null==iteratee&&null!=obj){obj=obj.length===+obj.length?obj:_.values(obj);for(var i=0,length=obj.length;length>i;i++)value=obj[i],result>value&&(result=value)}else iteratee=_.iteratee(iteratee,context),_.each(obj,function(value,index,list){computed=iteratee(value,index,list),(lastComputed>computed||1/0===computed&&1/0===result)&&(result=value,lastComputed=computed)});return result},_.shuffle=function(obj){for(var set=obj&&obj.length===+obj.length?obj:_.values(obj),length=set.length,shuffled=Array(length),index=0,rand;length>index;index++)rand=_.random(0,index),rand!==index&&(shuffled[index]=shuffled[rand]),shuffled[rand]=set[index];return shuffled},_.sample=function(obj,n,guard){return null==n||guard?(obj.length!==+obj.length&&(obj=_.values(obj)),obj[_.random(obj.length-1)]):_.shuffle(obj).slice(0,Math.max(0,n))},_.sortBy=function(obj,iteratee,context){return iteratee=_.iteratee(iteratee,context),_.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iteratee(value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(b>a||void 0===b)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,iteratee,context){var result={};return iteratee=_.iteratee(iteratee,context),_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key)}),result}};_.groupBy=group(function(result,value,key){_.has(result,key)?result[key].push(value):result[key]=[value]}),_.indexBy=group(function(result,value,key){result[key]=value}),_.countBy=group(function(result,value,key){_.has(result,key)?result[key]++:result[key]=1}),_.sortedIndex=function(array,obj,iteratee,context){iteratee=_.iteratee(iteratee,context,1);for(var value=iteratee(obj),low=0,high=array.length;high>low;){var mid=low+high>>>1;iteratee(array[mid])<value?low=mid+1:high=mid}return low},_.toArray=function(obj){return obj?_.isArray(obj)?slice.call(obj):obj.length===+obj.length?_.map(obj,_.identity):_.values(obj):[]},_.size=function(obj){return null==obj?0:obj.length===+obj.length?obj.length:_.keys(obj).length},_.partition=function(obj,predicate,context){predicate=_.iteratee(predicate,context);var pass=[],fail=[];return _.each(obj,function(value,key,obj){(predicate(value,key,obj)?pass:fail).push(value)}),[pass,fail]},_.first=_.head=_.take=function(array,n,guard){return null==array?void 0:null==n||guard?array[0]:0>n?[]:slice.call(array,0,n)},_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(null==n||guard?1:n)))},_.last=function(array,n,guard){return null==array?void 0:null==n||guard?array[array.length-1]:slice.call(array,Math.max(array.length-n,0))},_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,null==n||guard?1:n)},_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,strict,output){if(shallow&&_.every(input,_.isArray))return concat.apply(output,input);for(var i=0,length=input.length;length>i;i++){var value=input[i];_.isArray(value)||_.isArguments(value)?shallow?push.apply(output,value):flatten(value,shallow,strict,output):strict||output.push(value)}return output};_.flatten=function(array,shallow){return flatten(array,shallow,!1,[])},_.without=function(array){return _.difference(array,slice.call(arguments,1))},_.uniq=_.unique=function(array,isSorted,iteratee,context){if(null==array)return[];_.isBoolean(isSorted)||(context=iteratee,iteratee=isSorted,isSorted=!1),null!=iteratee&&(iteratee=_.iteratee(iteratee,context));for(var result=[],seen=[],i=0,length=array.length;length>i;i++){var value=array[i];if(isSorted)i&&seen===value||result.push(value),seen=value;else if(iteratee){var computed=iteratee(value,i,array);_.indexOf(seen,computed)<0&&(seen.push(computed),result.push(value))}else _.indexOf(result,value)<0&&result.push(value)}return result},_.union=function(){return _.uniq(flatten(arguments,!0,!0,[]))},_.intersection=function(array){if(null==array)return[];for(var result=[],argsLength=arguments.length,i=0,length=array.length;length>i;i++){var item=array[i];if(!_.contains(result,item)){for(var j=1;argsLength>j&&_.contains(arguments[j],item);j++);j===argsLength&&result.push(item)}}return result},_.difference=function(array){var rest=flatten(slice.call(arguments,1),!0,!0,[]);return _.filter(array,function(value){return!_.contains(rest,value)})},_.zip=function(array){if(null==array)return[];for(var length=_.max(arguments,"length").length,results=Array(length),i=0;length>i;i++)results[i]=_.pluck(arguments,i);return results},_.object=function(list,values){if(null==list)return{};for(var result={},i=0,length=list.length;length>i;i++)values?result[list[i]]=values[i]:result[list[i][0]]=list[i][1];return result},_.indexOf=function(array,item,isSorted){if(null==array)return-1;var i=0,length=array.length;if(isSorted){if("number"!=typeof isSorted)return i=_.sortedIndex(array,item),array[i]===item?i:-1;i=0>isSorted?Math.max(0,length+isSorted):isSorted}for(;length>i;i++)if(array[i]===item)return i;return-1},_.lastIndexOf=function(array,item,from){if(null==array)return-1;var idx=array.length;for("number"==typeof from&&(idx=0>from?idx+from+1:Math.min(idx,from+1));--idx>=0;)if(array[idx]===item)return idx;return-1},_.range=function(start,stop,step){arguments.length<=1&&(stop=start||0,start=0),step=step||1;for(var length=Math.max(Math.ceil((stop-start)/step),0),range=Array(length),idx=0;length>idx;idx++,start+=step)range[idx]=start;return range};var Ctor=function(){};_.bind=function(func,context){var args,bound;if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError("Bind must be called on a function");return args=slice.call(arguments,2),bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));Ctor.prototype=func.prototype;var self=new Ctor;Ctor.prototype=null;var result=func.apply(self,args.concat(slice.call(arguments)));return _.isObject(result)?result:self}},_.partial=function(func){var boundArgs=slice.call(arguments,1);return function(){for(var position=0,args=boundArgs.slice(),i=0,length=args.length;length>i;i++)args[i]===_&&(args[i]=arguments[position++]);for(;position<arguments.length;)args.push(arguments[position++]);return func.apply(this,args)}},_.bindAll=function(obj){var i,length=arguments.length,key;if(1>=length)throw new Error("bindAll must be passed function names");for(i=1;length>i;i++)key=arguments[i],obj[key]=_.bind(obj[key],obj);return obj},_.memoize=function(func,hasher){var memoize=function(key){var cache=memoize.cache,address=hasher?hasher.apply(this,arguments):key;return _.has(cache,address)||(cache[address]=func.apply(this,arguments)),cache[address]};return memoize.cache={},memoize},_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)},_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))},_.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=options.leading===!1?0:_.now(),timeout=null,result=func.apply(context,args),timeout||(context=args=null)};return function(){var now=_.now();previous||options.leading!==!1||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,0>=remaining||remaining>wait?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args),timeout||(context=args=null)):timeout||options.trailing===!1||(timeout=setTimeout(later,remaining)),result}},_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result,later=function(){var last=_.now()-timestamp;wait>last&&last>0?timeout=setTimeout(later,wait-last):(timeout=null,immediate||(result=func.apply(context,args),timeout||(context=args=null)))};return function(){context=this,args=arguments,timestamp=_.now();var callNow=immediate&&!timeout;return timeout||(timeout=setTimeout(later,wait)),callNow&&(result=func.apply(context,args),context=args=null),result}},_.wrap=function(func,wrapper){return _.partial(wrapper,func)},_.negate=function(predicate){return function(){return!predicate.apply(this,arguments)}},_.compose=function(){var args=arguments,start=args.length-1;return function(){for(var i=start,result=args[start].apply(this,arguments);i--;)result=args[i].call(this,result);return result}},_.after=function(times,func){return function(){return--times<1?func.apply(this,arguments):void 0}},_.before=function(times,func){var memo;return function(){return--times>0?memo=func.apply(this,arguments):func=null,memo}},_.once=_.partial(_.before,2),_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)_.has(obj,key)&&keys.push(key);return keys},_.values=function(obj){for(var keys=_.keys(obj),length=keys.length,values=Array(length),i=0;length>i;i++)values[i]=obj[keys[i]];return values},_.pairs=function(obj){for(var keys=_.keys(obj),length=keys.length,pairs=Array(length),i=0;length>i;i++)pairs[i]=[keys[i],obj[keys[i]]];return pairs},_.invert=function(obj){for(var result={},keys=_.keys(obj),i=0,length=keys.length;length>i;i++)result[obj[keys[i]]]=keys[i];return result},_.functions=_.methods=function(obj){var names=[];for(var key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()},_.extend=function(obj){if(!_.isObject(obj))return obj;for(var source,prop,i=1,length=arguments.length;length>i;i++){source=arguments[i];for(prop in source)hasOwnProperty.call(source,prop)&&(obj[prop]=source[prop])}return obj},_.pick=function(obj,iteratee,context){var result={},key;if(null==obj)return result;if(_.isFunction(iteratee)){iteratee=createCallback(iteratee,context);for(key in obj){var value=obj[key];iteratee(value,key,obj)&&(result[key]=value)}}else{var keys=concat.apply([],slice.call(arguments,1));obj=new Object(obj);for(var i=0,length=keys.length;length>i;i++)key=keys[i],key in obj&&(result[key]=obj[key])}return result},_.omit=function(obj,iteratee,context){if(_.isFunction(iteratee))iteratee=_.negate(iteratee);else{var keys=_.map(concat.apply([],slice.call(arguments,1)),String);iteratee=function(value,key){return!_.contains(keys,key)}}return _.pick(obj,iteratee,context)},_.defaults=function(obj){if(!_.isObject(obj))return obj;for(var i=1,length=arguments.length;length>i;i++){var source=arguments[i];for(var prop in source)void 0===obj[prop]&&(obj[prop]=source[prop])}return obj},_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj};var eq=function(a,b,aStack,bStack){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof _&&(a=a._wrapped),b instanceof _&&(b=b._wrapped);var className=toString.call(a);if(className!==toString.call(b))return!1;switch(className){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}if("object"!=typeof a||"object"!=typeof b)return!1;for(var length=aStack.length;length--;)if(aStack[length]===a)return bStack[length]===b;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&"constructor"in a&&"constructor"in b&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor))return!1;aStack.push(a),bStack.push(b);var size,result;if("[object Array]"===className){if(size=a.length,result=size===b.length)for(;size--&&(result=eq(a[size],b[size],aStack,bStack)););}else{var keys=_.keys(a),key;if(size=keys.length,result=_.keys(b).length===size)for(;size--&&(key=keys[size],result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack)););}return aStack.pop(),bStack.pop(),result};_.isEqual=function(a,b){return eq(a,b,[],[])},_.isEmpty=function(obj){if(null==obj)return!0;if(_.isArray(obj)||_.isString(obj)||_.isArguments(obj))return 0===obj.length;for(var key in obj)if(_.has(obj,key))return!1;return!0},_.isElement=function(obj){return!(!obj||1!==obj.nodeType)},_.isArray=nativeIsArray||function(obj){return"[object Array]"===toString.call(obj)},_.isObject=function(obj){var type=typeof obj;return"function"===type||"object"===type&&!!obj},_.each(["Arguments","Function","String","Number","Date","RegExp"],function(name){_["is"+name]=function(obj){return toString.call(obj)==="[object "+name+"]"}}),_.isArguments(arguments)||(_.isArguments=function(obj){return _.has(obj,"callee")}),"function"!=typeof/./&&(_.isFunction=function(obj){return"function"==typeof obj||!1}),_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))},_.isNaN=function(obj){return _.isNumber(obj)&&obj!==+obj},_.isBoolean=function(obj){return obj===!0||obj===!1||"[object Boolean]"===toString.call(obj)},_.isNull=function(obj){return null===obj},_.isUndefined=function(obj){return void 0===obj},_.has=function(obj,key){return null!=obj&&hasOwnProperty.call(obj,key)},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.constant=function(value){return function(){return value}},_.noop=function(){},_.property=function(key){return function(obj){return obj[key]}},_.matches=function(attrs){var pairs=_.pairs(attrs),length=pairs.length;return function(obj){if(null==obj)return!length;obj=new Object(obj);for(var i=0;length>i;i++){var pair=pairs[i],key=pair[0];if(pair[1]!==obj[key]||!(key in obj))return!1}return!0}},_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=createCallback(iteratee,context,1);for(var i=0;n>i;i++)accum[i]=iteratee(i);return accum},_.random=function(min,max){return null==max&&(max=min,min=0),min+Math.floor(Math.random()*(max-min+1))},_.now=Date.now||function(){return(new Date).getTime()};var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},unescapeMap=_.invert(escapeMap),createEscaper=function(map){var escaper=function(match){return map[match]},source="(?:"+_.keys(map).join("|")+")",testRegexp=RegExp(source),replaceRegexp=RegExp(source,"g");return function(string){return string=null==string?"":""+string,testRegexp.test(string)?string.replace(replaceRegexp,escaper):string}};_.escape=createEscaper(escapeMap),_.unescape=createEscaper(unescapeMap),_.result=function(object,property){if(null==object)return void 0;var value=object[property];return _.isFunction(value)?object[property]():value};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/,escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},escaper=/\\|'|\r|\n|\u2028|\u2029/g,escapeChar=function(match){return"\\"+escapes[match]};_.template=function(text,settings,oldSettings){!settings&&oldSettings&&(settings=oldSettings),settings=_.defaults({},settings,_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g"),index=0,source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){return source+=text.slice(index,offset).replace(escaper,escapeChar),index=offset+match.length,escape?source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'":interpolate?source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'":evaluate&&(source+="';\n"+evaluate+"\n__p+='"),match}),source+="';\n",settings.variable||(source="with(obj||{}){\n"+source+"}\n"),source="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{var render=new Function(settings.variable||"obj","_",source)}catch(e){throw e.source=source,e}var template=function(data){return render.call(this,data,_)},argument=settings.variable||"obj";return template.source="function("+argument+"){\n"+source+"}",template},_.chain=function(obj){var instance=_(obj);return instance._chain=!0,instance};var result=function(obj){return this._chain?_(obj).chain():obj};_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];return push.apply(args,arguments),result.call(this,func.apply(_,args))}})},_.mixin(_),_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;return method.apply(obj,arguments),"shift"!==name&&"splice"!==name||0!==obj.length||delete obj[0],result.call(this,obj)}}),_.each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}}),_.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}).call(this)},{}]},{},[1])(1)});